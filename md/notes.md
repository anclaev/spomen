# Notes

- Агрегат = репозиторий
- Сервис = сервис (интерфейс (entity) + реализация (service))
- Контракты через zod
- Для контрактов используются интерфейсы

### Слой домена

- Корень агрегата = класс extends AggregateRoot
- Репозиторий - отвечает за работы с хранилищем = abstract class, определяет контракт - реализация в инфраструктуре, создаётся только для агрегатов

### Прикладной слой (application)

- CQRS! (запросы, команды)
- DTO

### Слой инфраструктуры

- реализует контракты со всех слоев (presentation, application, domain)
- ORM entity - отдельные, не должны выходить за границы инфраструктуры, выступают контейнерами данных

### Домены

| Домен                 | Агрегат                | Метаданные (объекты-значения)         |
| --------------------- | ---------------------- | ------------------------------------- |
| Воспоминание (Memory) |
|                       | Таймлайн (Timeline)    |
|                       | Воспоминание (Memory)} |
|                       | Персона (Person)       |
|                       | Группа (Group)         |
| Биллинг (Billing)     |                        |
|                       | Баланс (Balance)       |
|                       | Счёт (Invoice)         |
|                       | Операция (Operation)   |
| Магазин (Shop)        |
|                       | Каталог (Catalog)      |
|                       | Заказ (Order)          |
|                       | Товар (Product)        |
|                       |                        | История изменений цены (PriceHistory) |
|                       |                        | Свойства (Props)                      |
|                       | Корзина (Basket)       |
|                       | Доставка (Delivery)    |
|                       | Оплата (Payment)       |
|                       | Склад (Darkstore)      |
| Аккаунт (Account)     |
|                       | Аккаунт(Account)       |
|                       |                        | Сессии (Sessions)                     |
|                       |                        | История сессий (SessionHistory)       |
| Хранилище (Storage)   |
|                       | Загрузка (Upload)      |

- Kafka\* - как асинхронный брокер сообщений и шина между сервисами
